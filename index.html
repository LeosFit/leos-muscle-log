<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Muscle Log with Graphs</title>
<style>
  body {
    font-family: 'Courier New', monospace;
    background: #0a0a0a;
    color: #eee;
    padding: 20px;
  }
  h1 {
    color: #00ff99;
    text-shadow: 0 0 5px #00ff99;
    text-align: center;
    margin-bottom: 40px;
  }
  .accordion {
    background-color: #1a1a1a;
    color: #eee;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    text-align: left;
    outline: none;
    border: none;
    transition: 0.3s;
    font-size: 18px;
    margin-bottom: 10px;
    border-left: 5px solid #00ff99;
  }
  .active, .accordion:hover {
    background-color: #262626;
  }
  .panel {
    padding: 0 18px;
    background-color: #141414;
    display: none;
    overflow: hidden;
    border-left: 5px solid #00ff99;
    margin-bottom: 20px;
  }
  label {
    margin-top: 10px;
    display: block;
    font-weight: bold;
    color: #fff;
  }
  textarea, input[type="text"], input[type="number"], input[type="date"] {
    width: 100%;
    background: #111;
    border: 1px solid #333;
    color: #00ff99;
    padding: 10px;
    margin: 10px 0 20px 0;
    font-family: 'Courier New', monospace;
    resize: vertical;
  }
  footer {
    text-align: center;
    font-size: 12px;
    margin-top: 50px;
    color: #666;
  }
  canvas {
    background: #111;
    border: 1px solid #333;
    margin-top: 20px;
    border-radius: 5px;
  }
  .small-input {
    width: 48%;
    display: inline-block;
  }
  .half {
    width: 48%;
    display: inline-block;
  }
  .half-right {
    float: right;
  }
</style>
</head>
<body>

<h1>Muscle Log</h1>

<button class="accordion">Push Day</button>
<div class="panel">
  <label for="bench">Flat Barbell Bench Press</label>
  <textarea id="bench" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="dbpress">Seated DB Shoulder Press</label>
  <textarea id="dbpress" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="incline">Incline DB Press</label>
  <textarea id="incline" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="laterals">Lateral Raises</label>
  <textarea id="laterals" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="pushdowns">Triceps Rope Pushdowns</label>
  <textarea id="pushdowns" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="ohtriceps">Overhead Triceps Extension</label>
  <textarea id="ohtriceps" placeholder="Enter sets/reps/weight..."></textarea>
</div>

<button class="accordion">Pull Day</button>
<div class="panel">
  <label for="pullups">Weighted Pull-ups</label>
  <textarea id="pullups" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="row">Barbell Row</label>
  <textarea id="row" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="lat">Lat Pulldown</label>
  <textarea id="lat" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="curls">Dumbbell Curls</label>
  <textarea id="curls" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="hammers">Hammer Curls</label>
  <textarea id="hammers" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="facepull">Face Pulls</label>
  <textarea id="facepull" placeholder="Enter sets/reps/weight..."></textarea>
</div>

<button class="accordion">Leg Day</button>
<div class="panel">
  <label for="squat">Barbell Back Squat</label>
  <textarea id="squat" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="rdl">Romanian Deadlifts</label>
  <textarea id="rdl" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="lunges">Walking Lunges</label>
  <textarea id="lunges" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="legpress">Leg Press</label>
  <textarea id="legpress" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="legcurl">Seated Leg Curl</label>
  <textarea id="legcurl" placeholder="Enter sets/reps/weight..."></textarea>

  <label for="calves">Standing Calf Raises</label>
  <textarea id="calves" placeholder="Enter sets/reps/weight..."></textarea>
</div>

<button class="accordion">Nutrition</button>
<div class="panel">
  <label for="calories">Total Calories</label>
  <input type="number" id="calories" min="0" placeholder="Target: 3200–3300" />

  <label for="protein">Protein (g)</label>
  <input type="number" id="protein" min="0" placeholder="Target: 180–200" />

  <label for="carbs">Carbs (g)</label>
  <input type="number" id="carbs" min="0" placeholder="Target: 400–450" />

  <label for="fats">Fats (g)</label>
  <input type="number" id="fats" min="0" placeholder="Target: 80–90" />

  <label for="meals">Meal Notes</label>
  <textarea id="meals" placeholder="Any missed meals, cravings, digestion notes, etc."></textarea>
</div>

<button class="accordion">Sleep & Recovery</button>
<div class="panel">
  <label for="sleep">Hours Slept</label>
  <input type="number" id="sleep" min="0" max="24" step="0.25" placeholder="Did you hit 7.5–9 hrs?" />

  <label for="energy">Morning Energy / Mood</label>
  <textarea id="energy" placeholder="Note your energy or mental clarity today."></textarea>

  <label for="recovery">Muscle Soreness / Fatigue</label>
  <textarea id="recovery" placeholder="How recovered are you feeling?"></textarea>
</div>

<button class="accordion">Supplements</button>
<div class="panel">
  <label for="supplements">Supplements Taken</label>
  <textarea id="supplements" placeholder="List supplements, dosages, timing..."></textarea>
</div>

<button class="accordion">Graphs</button>
<div class="panel">
  <label for="graphDate">Select Date</label>
  <input type="date" id="graphDate" />

  <canvas id="calorieChart" width="400" height="200"></canvas>
  <canvas id="sleepChart" width="400" height="200"></canvas>
  <canvas id="proteinChart" width="400" height="200"></canvas>
</div>

<footer>Data is stored in your browser.</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const acc = document.getElementsByClassName("accordion");
  for (let i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function () {
      this.classList.toggle("active");
      const panel = this.nextElementSibling;
      panel.style.display = panel.style.display === "block" ? "none" : "block";
      if(this.textContent.trim() === "Graphs" && panel.style.display === "block") {
        updateGraphs();
      }
    });
  }

  const saveField = (id, value) => {
    let today = new Date().toISOString().slice(0,10);
    let data = JSON.parse(localStorage.getItem(id) || "{}");
    data[today] = value;
    localStorage.setItem(id, JSON.stringify(data));
  };

  const loadField = (id) => {
    let today = new Date().toISOString().slice(0,10);
    let data = JSON.parse(localStorage.getItem(id) || "{}");
    return data[today] || "";
  };

  // Setup inputs
  const inputs = document.querySelectorAll("textarea, input[type=number], input[type=text]");
  inputs.forEach(input => {
    const id = input.id;
    input.value = loadField(id);
    input.addEventListener("input", () => {
      saveField(id, input.value);
    });
  });

  // Date selector for graphs
  const graphDate = document.getElementById("graphDate");
  graphDate.value = new Date().toISOString().slice(0,10);
  graphDate.addEventListener("change", updateGraphs);

  // Chart.js setup
  const getDatesLastNDays = (n) => {
    let dates = [];
    for(let i=n-1; i>=0; i--) {
      let d = new Date();
      d.setDate(d.getDate() - i);
      dates.push(d.toISOString().slice(0,10));
    }
    return dates;
  };

  let calorieChart, sleepChart, proteinChart;

  function createChart(ctx, label, data, color) {
    return new Chart(ctx, {
      type: 'line',
      data: {
        labels: data.dates,
        datasets: [{
          label: label,
          data: data.values,
          fill: false,
          borderColor: color,
          tension: 0.3,
          pointRadius: 4,
          pointHoverRadius: 7,
          borderWidth: 3,
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: false,
            ticks: { color: '#00ff99' }
          },
          x: {
            ticks: { color: '#00ff99' }
          }
        },
        plugins: {
          legend: {
            labels: {
              color: '#00ff99'
            }
          }
        },
        responsive: true,
        maintainAspectRatio: false,
      }
    });
  }

  function updateGraphs() {
    const dates = getDatesLastNDays(14);
    // Pull stored data
    const getDataForKey = (key) => {
      const allData = JSON.parse(localStorage.getItem(key) || "{}");
      return dates.map(d => Number(allData[d]) || 0);
    };

    // Prepare data sets
    const calorieData = { dates: dates, values: getDataForKey('calories') };
    const sleepData = { dates: dates, values: getDataForKey('sleep') };
    const proteinData = { dates: dates, values: getDataForKey('protein') };

    if(calorieChart) calorieChart.destroy();
    if(sleepChart) sleepChart.destroy();
    if(proteinChart) proteinChart.destroy();

    calorieChart = createChart(document.getElementById('calorieChart').getContext('2d'), 'Calories', calorieData, '#00ff99');
    sleepChart = createChart(document.getElementById('sleepChart').getContext('2d'), 'Sleep (hours)', sleepData, '#0099ff');
    proteinChart = createChart(document.getElementById('proteinChart').getContext('2d'), 'Protein (g)', proteinData, '#ff5500');
  }
</script>
</body>
</html>
